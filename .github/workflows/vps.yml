name: VPS FullSpeed

on:
  workflow_dispatch:

jobs:
  vps:
    runs-on: ubuntu-latest
    timeout-minutes: 360   # tối đa 6h

    steps:
      - name: Cài đặt tmate và tạo session
        run: |
          sudo apt-get update -y
          sudo apt-get install -y tmate
          tmate -S /tmp/tmate.sock new-session -d "bash -l"
          tmate -S /tmp/tmate.sock wait tmate-ready
          echo "SSH: $(tmate -S /tmp/tmate.sock display -p '#{tmate_ssh}')" | tee -a $GITHUB_STEP_SUMMARY
          echo "WEB: $(tmate -S /tmp/tmate.sock display -p '#{tmate_web}')" | tee -a $GITHUB_STEP_SUMMARY
          echo ">>> VPS sẽ chạy liên tục trong 360 phút (6h)."

      - name: Giữ VPS online
        run: |
          while true; do
            echo ">> VPS vẫn chạy... $(date)"
            sleep 300
          done
